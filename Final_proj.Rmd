---
title: "Final Project"
author: "Matthew Bentham"
date: "2023-04-30"
output: 
  
    html_document:
      fig_caption: true
      
css: style.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<center>
# Energy Demand Victoria 
##### MATH1318: Final Project \n\n
Matthew Bentham 3923076 \n
John Murrowood 3923075 \n
</center>

---

# Contents 

# 1. Introduction

With the resurrection of the SEC , announcement of offshore wind farms in south east Victoria and Victoria's renewable energy target of 50% by 2030, being able to accurately predict energy demand on a continual basis is becoming more and more important. As renewable energy sources like wind and solar do not produce constant energy outputs, accurate forecasting of energy demand throughout the day is essential to ensure renewable energy sources are utilized efficiently. Although demand forecasting is increasingly relevant when incorporating renewable into the grid, demand forecasting in general reduces over and underproduction of energy and minimizes energy waste as a whole.

**Data Source:**https://www.kaggle.com/datasets/aramacus/electricity-demand-in-victoria-australia 

This data set contains the total daily energy demand across Victoria in MWh from 1st Jan 2015 to 6 Oct 2020 which consists of 2016 days. Although the additional features of this data set may not be directly relevant to this report, below is a list of variables contained in the data and their description:

- **date** : datetime, the date of the recording
- **demand** : float, a total daily electricity demand in MWh
- **RRP** : float, a recommended retail price in AUD$ / MWh
- **demand_pos_RRP** : float, a total daily demand at positive RRP in MWh
- **RRP_positive** : float, an averaged positive RRP, weighted by the corresponding intraday demand in AUD$ / MWh
- **demand_neg_RRP** : float, an total daily demand at negative RRP in MWh
- **RRP_negative** : float, an average negative RRP, weighted by the corresponding intraday demand in AUD$ / MWh
- **frac_at_neg_RRP** : float, a fraction of the day when the demand was traded at negative RRP
- **min_temperature** : float, minimum temperature during the day in Celsius
- **max_temperature** : float, maximum temperature during the day in Celsius
- **solar_exposure** : float, total daily sunlight energy in MJ/m^2
- **rainfall** : float, daily rainfall in mm
- **school_day** : boolean, if students were at school on that day
- **holiday** : boolean, if the day was a state or national holiday


*Note* : All code provided is written in Rstudio using R 4.2.0



```{r, include=FALSE}
library(readr)
library(ggplot2)
library(dplyr)
library(ggfortify)
library(xts)
library(TSA)
library(lmtest)
library(tseries)
library(forecast)
```

```{r, include=FALSE}
sort.score <- function(x, score = c("bic", "aic")){
if (score == "aic"){
x[with(x, order(AIC)),]
} else if (score == "bic") {
x[with(x, order(BIC)),]
} else {
warning('score = "x" only accepts valid arguments ("aic","bic")')
}
}
```


# 2. Preliminary Analysis

## 2.1 Import and Analyse Dataset

To further investigate the time series data, the data set is first imported and converted to a time series object. This time series object is then plotted using the plot() function in order to visualize its main characteristics.

```{r , message=FALSE,fig.align="center",class.source="cobalt",fig.width=20, fig.height=8}

Data <- read_csv("complete_dataset.csv")

# Convert Dataframe to Timeseries:
xts(Data$`demand`, Data$date)   
Data_ts <- xts(Data$`demand`, Data$date)   

head(Data)
#Plot the Time Series:
plot(Data_ts,type="o",ylab="Total daily electricity demand (MWh)",xlab="Year",
     main="Figure 1:Time Series of Victoria energy demand")

```

Time series characteristics observed from the above plot:   
- **Trend**: No clear directional     
- **Variance**: No obvious changing variance    
- **Seasonality**: Needs to be further investigated, however just from the time series it can be seen all the peaks occurring around July each year with short spikes occurring every January a This is as expected as generally more electricity is used during winter with the exception of very hot days during January aswell that is likely to cause large uptake in cooling systems.
- **Change Point**: No clear change point observed

```{r , message=FALSE,fig.align="center",class.source="cobalt"}
# Summary Stats
summary(Data_ts)
```
## 2.2 Impact of previous days

Another useful initial analysis to conduct is to determine whether or not previous years share a strong correlation or not. 
```{r}
# plot lag 1 scatterplot
plot(y=Data_ts,x=zlag(Data_ts),ylab="Arctic Sea Ice Extent (million square km)", xlab='Previous years values', main = "Figure 2: Lag 1 Plot.") 
```

```{r}
y = Data_ts    
x = zlag(Data_ts)   # Generate first lag of the series
index = 2:length(x)  # Create an index to get rid of the first NA value in x
cor(y[index],x[index]) # Compute correlation coefficient of the data with its first lag
```

The scatter plot above shows that there is a moderate positive correlation between the energy demand on a given day and its succeeding days. the correlation coefficient of 0.67 shows that the correlation is moderate and confirms that the time series data exhibits some form of positive autocorrelation and the data is NOT randomly distributed. 


## 2.2 Import and Analyse Dataset


# 3. Data transformations

# 4. Model specification

# 5. Parameter Estimation

# 6. Model Diagnostics

# 7. Conclusion

# 8. References
